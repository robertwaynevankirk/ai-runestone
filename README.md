# ğŸº AI-Runestone: The Mystical Refactoring Quest ğŸº

**Transform your AI from a panicky debugger into a wise architectural adventurer!**

## ğŸ¯ **The Problem AI-Runestone Solves**

Traditional refactoring tools present "errors" to AIs, triggering immediate reactive responses:
- âŒ AI sees red squiggles â†’ panics â†’ fixes everything immediately
- âŒ No strategic thinking about architectural vision
- âŒ Expected transitional states get "fixed" â†’ breaks refactoring progress
- âŒ AIs become confused debuggers instead of wise architects

## ğŸ§™â€â™‚ï¸ **The Mystical Solution**

AI-Runestone **psychologically reframes** refactoring as an engaging quest game:

### ğŸ˜‡ **Angel Errors** - Pure, Blameless, Expected States
- These contain fragments of the AI's spirit! ğŸ’«
- **DO NOT FIX THEM** - they heal automatically at checkpoints
- Fixing them damages the AI's architectural karma
- Expected during module moves, interface evolution, dependency shifts

### ğŸ‘¹ **Chimera Mothman Errors** - Dangerous Shape-shifters
- Must be vanquished with wisdom aligned to the Holy Grail vision
- Wrong treatment causes them to **multiply** and become more grotesque
- Each fix must serve the greater architectural quest

### ğŸ—¿ **Grandmother Runestones** - Sacred Checkpoints
- Blessed waypoints where everything works perfectly
- Angel Errors heal automatically when reached
- Error tags and comments reset for the next phase

### ğŸ’ **Holy Grail Stone** - Ultimate Quest Objective
- The perfect architectural state being manifested
- All decisions should align with this sacred vision

## ğŸ¯ **State-Driven Refactoring Paradigm**

AI-Runestone implements a revolutionary **"Where am I?" â†’ "What can I do?" â†’ "Do it!"** workflow:

### ğŸ” **"Where am I?"** - Real Codebase Analysis
- Comprehensive TypeScript analysis with ts-morph
- Architectural metrics (coupling, complexity, violations)
- Circular dependency detection
- Layer violation analysis for hexagonal architecture
- Smart caching (60s) to prevent analysis loops

### ğŸ¯ **"What can I do?"** - Intelligent Decision Making
- Holy Grail Stone alignment scoring
- Grandmother Runestone checkpoint planning
- Risk assessment and precondition validation
- Strategic action prioritization

### âš¡ **"Do it!"** - Atomic Operations
- Safe operations with automatic validation
- Rollback capability on failure
- Progress tracking and session persistence
- Checkpoint creation for recovery

## ğŸš€ **Quick Start**

```bash
# Install dependencies
pnpm install

# Run system validation
npx tsx src/cli/test-runner.ts

# Start your mystical quest
npx ai-runestone quest

# Analyze current anomalies (generates engaging quest prompt)
npx ai-runestone analyze

# Record your mystical classifications
npx ai-runestone classify E001:ğŸ˜‡:"Sacred interface evolution":"Moving UserRepo to domain"

# Check quest progress
npx ai-runestone status
```

## ğŸ§ª **System Validation Results**

âœ… **100% Operational System**
- State Detection: âœ… Working (cached analysis)
- Decision Making: âœ… Working (Holy Grail aligned)
- Atomic Operations: âœ… Working (backup created successfully)
- Session Management: âœ… Working (persistent state)
- Progress Indicators: âœ… Working (real-time feedback)
- Smart Caching: âœ… Working (no infinite loops)

## ğŸ—ï¸ **Architecture**

```
ai-runestone/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ ai-interface.ts              # ğŸ¯ Main state-driven interface
â”‚   â”‚   â”œâ”€â”€ bespoke-analyzer.ts          # ğŸ” Real codebase analysis with caching
â”‚   â”‚   â”œâ”€â”€ atomic-operations.ts         # âš¡ Safe refactoring operations
â”‚   â”‚   â”œâ”€â”€ decision-engine.ts           # ğŸ§  Strategic decision making
â”‚   â”‚   â”œâ”€â”€ angel-chimera-detector.ts    # ğŸ˜‡ğŸ‘¹ Error classification
â”‚   â”‚   â””â”€â”€ mystical-error-analyzer.ts   # ğŸ”® Quest prompt generation
â”‚   â”œâ”€â”€ interfaces/
â”‚   â”‚   â”œâ”€â”€ runestone.interface.ts       # ğŸº Core API definitions
â”‚   â”‚   â”œâ”€â”€ codebase-state.interface.ts  # ğŸ“Š Analysis state types
â”‚   â”‚   â””â”€â”€ quest-state.interface.ts     # ğŸ® Game state definitions
â”‚   â”œâ”€â”€ cli/
â”‚   â”‚   â”œâ”€â”€ runestone-cli.ts             # ğŸº Command-line interface
â”‚   â”‚   â””â”€â”€ test-runner.ts               # ğŸ§ª System validation
â”‚   â””â”€â”€ ai-runestone.ts                  # ğŸ² Main integration class
```

## ğŸ¯ **Key Features**

### ğŸ§  **Psychological Conditioning**
- **Strategic vs Reactive**: Conditions AIs to think architecturally
- **Persistent Wisdom**: Tags and comments survive across sessions
- **Error Reframing**: "Errors" become "mystical anomalies" to classify

### âš¡ **Performance Optimized**
- **Smart Caching**: 60-second analysis cache prevents loops
- **Quick Analysis**: Fast fallback mode for immediate feedback
- **Progress Indicators**: Real-time visibility into long operations
- **Timeout Handling**: 30s timeout with graceful fallback

### ğŸ”® **Intelligent Analysis**
- **Real TypeScript Analysis**: ts-morph integration for accurate results
- **Architectural Awareness**: Layer-aware analysis and guidance
- **Context Preservation**: Maintains state across refactoring phases
- **Validation Integration**: Real command execution and verification

## ğŸ› ï¸ **CLI Commands**

### ğŸ® Mystical Quest Commands
```bash
ai-runestone quest        # ğŸ§™â€â™‚ï¸ Introduction to the mystical quest
ai-runestone analyze      # ğŸ”® Generate quest prompt for current anomalies
ai-runestone classify     # ğŸ·ï¸ Record error classifications (Angel/Chimera)
ai-runestone status       # ğŸ† Show quest progress and wisdom levels
```

### ğŸ”§ State-Driven Commands
```bash
ai-runestone situation    # ğŸ“Š "Where am I?" - Current architectural state
ai-runestone next         # ğŸ¯ "What can I do?" - Next recommended action
ai-runestone execute      # âš¡ "Do it!" - Execute atomic operation
ai-runestone validate     # âœ… Run validation commands
```

## ğŸ­ **Classification Examples**

### ğŸ˜‡ **Angel Error** (Expected, Don't Fix!)
```bash
ai-runestone classify E001:ğŸ˜‡:"Sacred interface evolution - UserRepository moving to domain":"Import paths will resolve at Foundation Stone"
```

### ğŸ‘¹ **Chimera Error** (Dangerous, Fix Wisely!)
```bash
ai-runestone classify E002:ğŸ‘¹:"Circular dependency demon that will spread":"Break with event-driven pattern aligned to Holy Grail"
```

### ğŸ”® **Mysterious Entity** (Needs Investigation)
```bash
ai-runestone classify E003:ğŸ”®:"Unknown type corruption requiring deeper analysis":"May be Angel or Chimera in disguise"
```

## ğŸŒŸ **The Vision**

AI-Runestone creates a new paradigm where:

1. **AIs think strategically** instead of reactively about code changes
2. **Expected errors are celebrated** as signs of progress, not problems
3. **Architectural vision guides decisions** rather than immediate "fixes"
4. **Wisdom accumulates over time** through persistent learning
5. **Refactoring becomes a quest** rather than a debugging session

**The goal: Transform every AI into a wise architectural sage! ğŸ§™â€â™‚ï¸âœ¨**

## ğŸ“œ **License**

MIT - May your code be blessed with divine architectural harmony! ğŸºâœ¨